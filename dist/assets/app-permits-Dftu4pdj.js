const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-utils-BDwnIIkN.js","assets/app-calculations-BTm-MLQ7.js","assets/state-vendor-C5Drl_aA.js","assets/react-CcDwFy_c.js","assets/react-dom-CAPYOVrm.js","assets/polyfills-CELajPCl.js","assets/vendor-Cv8-97MN.js","assets/app-calculator-BxQMOd7r.js","assets/app-editors-DF1OQL1O.js","assets/app-geodata-OF3I9fsg.js","assets/zip-utils-BoTj1NZG.js","assets/app-diagrams-CPhSrkc4.js","assets/app-io-D6-Ks0MZ.js"])))=>i.map(i=>d[i]);
import{_ as N}from"./app-calculator-BxQMOd7r.js";import{l as I}from"./app-utils-BDwnIIkN.js";function X({env:i,results:l,job:n,effectiveProfile:w,cachedMidspans:s,store:a}){var m,r,o,e,b,T,y,P,L;if(!l)throw new Error("results required");const g=i==="railroad"?"CSX Railroad Crossing":i==="wvHighway"?"WVDOH MM109":"General",f=(Array.isArray(s)?s:[]).filter(p=>((p==null?void 0:p.environment)||"")===i),c=f.map(p=>Number(p==null?void 0:p.targetFt)).filter(p=>Number.isFinite(p)),d=c.length?Math.max(...c):null,u=c.length?"cachedMidspans":"computed",t=c.length?f.reduce((p,F)=>Number(F==null?void 0:F.targetFt)>Number((p==null?void 0:p.targetFt)||-1/0)?F:p,null):null;return{type:g,job:{id:(n==null?void 0:n.id)||"",name:(n==null?void 0:n.name)||(a==null?void 0:a.projectName)||"",applicant:(n==null?void 0:n.applicantName)||(a==null?void 0:a.applicantName)||"",jobNumber:(n==null?void 0:n.jobNumber)||(a==null?void 0:a.jobNumber)||"",owner:(n==null?void 0:n.jobOwner)||(a==null?void 0:a.jobOwner)||"",commCompany:(n==null?void 0:n.commCompany)||"",submissionProfileName:(n==null?void 0:n.submissionProfileName)||""},profile:{...w},environment:i,pole:{heightFt:Number(a==null?void 0:a.poleHeight)||0,class:(a==null?void 0:a.poleClass)||"",gps:{lat:(a==null?void 0:a.poleLatitude)||"",lon:(a==null?void 0:a.poleLongitude)||""}},power:{voltage:a==null?void 0:a.existingPowerVoltage,heightFt:a==null?void 0:a.existingPowerHeight},span:{lengthFt:(m=l.span)==null?void 0:m.spanFt,midspanFt:(r=l.span)==null?void 0:r.midspanFt,targetFt:d!=null?d:(o=l.clearances)==null?void 0:o.groundClearance,computedGroundClearanceFt:(e=l.clearances)==null?void 0:e.groundClearance,targetSource:u,midLatitude:(t==null?void 0:t.midLat)||"",midLongitude:(t==null?void 0:t.midLon)||"",endpoints:{from:t!=null&&t.fromId?{id:t.fromId,latitude:(t==null?void 0:t.fromLat)||"",longitude:(t==null?void 0:t.fromLon)||""}:null,to:t!=null&&t.toId?{id:t.toId,latitude:(t==null?void 0:t.toLat)||"",longitude:(t==null?void 0:t.toLon)||""}:null}},attach:{proposedFt:(b=l.attach)==null?void 0:b.proposedAttachFt,basis:(y=(T=l.attach)==null?void 0:T.recommendation)==null?void 0:y.basis,detail:(L=(P=l.attach)==null?void 0:P.recommendation)==null?void 0:L.detail},timestamps:{generatedAt:new Date().toISOString()}}}async function B(i,l,n){const{loadPdfLib:w}=await N(async()=>{const{loadPdfLib:t}=await import("./app-utils-BDwnIIkN.js").then(m=>m.e);return{loadPdfLib:t}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12])),{PDFDocument:s,StandardFonts:a,rgb:g}=await w(),f=await s.load(i),c=await f.embedFont(a.Helvetica),d=await f.embedFont(a.HelveticaBold),u=f.getPages();for(const t of n||[]){const m=u[t.pageIndex||0];if(!m)continue;const r=l[t.key];r==null||r===""||m.drawText(String(r),{x:t.x,y:t.y,size:t.size||10,color:g(0,0,0),font:t.bold?d:c})}return await f.save()}async function V(i,l,n){const{loadPdfLib:w}=await N(async()=>{const{loadPdfLib:d}=await import("./app-utils-BDwnIIkN.js").then(u=>u.e);return{loadPdfLib:d}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12])),{PDFDocument:s}=await w(),{mapFieldNameToKey:a}=await N(async()=>{const{mapFieldNameToKey:d}=await Promise.resolve().then(()=>q);return{mapFieldNameToKey:d}},void 0),g=await s.load(i),c=g.getForm().getFields();for(const d of c)try{const u=d.getName(),t=a(u,l);if(!t)continue;const m=n[t];if(m==null||m==="")continue;const r=String(m);d.setText&&d.setText(r)}catch{}return await g.save()}async function G(i){const{loadPdfLib:l}=await N(async()=>{const{loadPdfLib:f}=await import("./app-utils-BDwnIIkN.js").then(c=>c.e);return{loadPdfLib:f}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12])),{PDFDocument:n}=await l(),s=(await n.load(i)).getPages(),a=s[0],g=a?a.getSize():{width:0,height:0};return{pages:s.length,firstPage:{width:g.width,height:g.height}}}async function z(i,l,n,w){let s=w;if(!s||!s.length){const{getLayoutFor:a}=await N(async()=>{const{getLayoutFor:f}=await import("./app-utils-BDwnIIkN.js").then(c=>c.h);return{getLayoutFor:f}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12])),g=await G(i);s=a(l,g)}return B(i,n,s)}const E=Object.freeze(Object.defineProperty({__proto__:null,fillAcroFormByName:V,fillPdfAuto:z,fillPdfWithFields:B,getPdfMeta:G},Symbol.toStringTag,{value:"Module"}));async function R(i){var y,P,L,p,F,S,C,v,D,k;const{PDFDocument:l,StandardFonts:n,rgb:w}=await I(),s=await l.create(),a=s.addPage([612,792]),g=await s.embedFont(n.Helvetica),f=await s.embedFont(n.HelveticaBold),c=(h,_,A,M=!1,O=12,H=w(0,0,0))=>{a.drawText(String(h!=null?h:""),{x:_,y:A,size:O,font:M?f:g,color:H})};c("WV DOH MM-109 Application (Draft)",50,750,!0,18),c(`Generated: ${new Date().toLocaleString()}`,50,730,!1,10,w(.2,.2,.2));const d=i.job||{},u=i.pole||{},t=i.span||{},m=i.attach||{},r=i.profile||{};let o=700;const e=(h,_)=>{c(h,50,o,!0),c(String(_!=null?_:""),220,o),o-=18};e("Applicant/Company:",d.applicant||""),e("Communications Co.:",d.commCompany||""),e("Job Name:",d.name||""),e("Job #:",d.jobNumber||""),e("Owner (Utility):",d.owner||""),e("Environment:",i.environment||""),e("Submission Profile:",(r==null?void 0:r.label)||(r==null?void 0:r.name)||""),e("Manifest Type:",(r==null?void 0:r.manifestType)||""),o-=6,c("Location",50,o,!0),o-=16,e("Pole Latitude:",((y=u.gps)==null?void 0:y.lat)||""),e("Pole Longitude:",((P=u.gps)==null?void 0:P.lon)||""),e("Pole Height (ft):",(L=u.heightFt)!=null?L:""),e("Pole Class:",u.class||""),e("Power (voltage):",((p=i.power)==null?void 0:p.voltage)||""),e("Power Height:",((F=i.power)==null?void 0:F.heightFt)||""),o-=6,c("Span",50,o,!0),o-=16,e("Span Length (ft):",(S=t.lengthFt)!=null?S:""),e("Target Ground Clearance (ft):",(C=t.targetFt)!=null?C:""),e("Computed Ground Clearance (ft):",(v=t.computedGroundClearanceFt)!=null?v:""),e("Midspan (ft):",(D=t.midspanFt)!=null?D:""),e("Target Source:",t.targetSource||""),o-=6,c("Attachment",50,o,!0),o-=16,e("Proposed Attach (ft):",(k=m.proposedFt)!=null?k:""),e("Basis:",m.basis||""),e("Detail:",m.detail||""),o-=10,c("Notes:",50,o,!0),o-=16;const b=["This draft contains calculated values and job metadata to assist with MM-109 preparation.","For Interstate crossings (new), ensure minimum 21 ft clearance is satisfied (profile configurable).","Validate location and attach heights against field conditions and owner requirements before submission."];for(const h of b)c(`• ${h}`,60,o),o-=14;return await s.save()}async function x(i){var y,P,L,p,F,S,C,v,D,k;const{PDFDocument:l,StandardFonts:n,rgb:w}=await I(),s=await l.create(),a=s.addPage([612,792]),g=await s.embedFont(n.Helvetica),f=await s.embedFont(n.HelveticaBold),c=(h,_,A,M=!1,O=12,H=w(0,0,0))=>{a.drawText(String(h!=null?h:""),{x:_,y:A,size:O,font:M?f:g,color:H})};c("Railroad Crossing Application (Draft: CSX)",50,750,!0,18),c(`Generated: ${new Date().toLocaleString()}`,50,730,!1,10,w(.2,.2,.2));const d=i.job||{},u=i.pole||{},t=i.span||{},m=i.attach||{},r=i.profile||{};let o=700;const e=(h,_)=>{c(h,50,o,!0),c(String(_!=null?_:""),260,o),o-=18};e("Applicant/Company:",d.applicant||""),e("Communications Co.:",d.commCompany||""),e("Job Name:",d.name||""),e("Job #:",d.jobNumber||""),e("Owner (Utility):",d.owner||""),e("Environment:",i.environment||""),e("Submission Profile:",(r==null?void 0:r.label)||(r==null?void 0:r.name)||""),e("Manifest Type:",(r==null?void 0:r.manifestType)||""),o-=6,c("Location",50,o,!0),o-=16,e("Pole Latitude:",((y=u.gps)==null?void 0:y.lat)||""),e("Pole Longitude:",((P=u.gps)==null?void 0:P.lon)||""),e("Pole Height (ft):",(L=u.heightFt)!=null?L:""),e("Pole Class:",u.class||""),e("Power (voltage):",((p=i.power)==null?void 0:p.voltage)||""),e("Power Height:",((F=i.power)==null?void 0:F.heightFt)||""),o-=6,c("Span",50,o,!0),o-=16,e("Span Length (ft):",(S=t.lengthFt)!=null?S:""),e("Target Ground Clearance (ft):",(C=t.targetFt)!=null?C:""),e("Computed Ground Clearance (ft):",(v=t.computedGroundClearanceFt)!=null?v:""),e("Midspan (ft):",(D=t.midspanFt)!=null?D:""),e("Target Source:",t.targetSource||""),o-=6,c("Attachment",50,o,!0),o-=16,e("Proposed Attach (ft):",(k=m.proposedFt)!=null?k:""),e("Basis:",m.basis||""),e("Detail:",m.detail||""),o-=10,c("Notes:",50,o,!0),o-=16;const b=["Target ground clearance for railroad crossings is typically 27 ft (profile configurable).","Ensure vertical and horizontal clearances meet railroad standards and owner requirements.","Provide plan/profile drawing, location map, and contact information with the official submittal."];for(const h of b)c(`• ${h}`,60,o),o-=14;return await s.save()}const U=Object.freeze(Object.defineProperty({__proto__:null,buildCSXPDF:x,buildMM109PDF:R},Symbol.toStringTag,{value:"Module"})),J=[{re:/applicant|applicant[_\s-]*name|owner[_\s-]*name|company[_\s-]*name/i,key:"applicant"},{re:/project|job[_\s-]*name|work[_\s-]*description/i,key:"jobName"},{re:/job[_\s-]*no|job[_\s-]*number|permit[_\s-]*no/i,key:"jobNumber"},{re:/latitude|lat\b/i,key:"poleLatitude"},{re:/longitude|lon\b|long\b/i,key:"poleLongitude"},{re:/mid[_\s-]*span[_\s-]*lat|midpoint[_\s-]*lat/i,key:"midLatitude"},{re:/mid[_\s-]*span[_\s-]*lon|mid[_\s-]*span[_\s-]*long|midpoint[_\s-]*lon|midpoint[_\s-]*long/i,key:"midLongitude"},{re:/from[_\s-]*(pole)?[_\s-]*id/i,key:"fromPoleId"},{re:/to[_\s-]*(pole)?[_\s-]*id/i,key:"toPoleId"},{re:/from[_\s-]*lat/i,key:"fromLatitude"},{re:/from[_\s-]*lon|from[_\s-]*long/i,key:"fromLongitude"},{re:/to[_\s-]*lat/i,key:"toLatitude"},{re:/to[_\s-]*lon|to[_\s-]*long/i,key:"toLongitude"},{re:/contact|phone|tel/i,key:"contactPhone"},{re:/email/i,key:"contactEmail"},{re:/clearance|vertical[_\s-]*clearance|ground[_\s-]*clearance/i,key:"targetGroundClearanceFt"},{re:/span[_\s-]*length|length[_\s-]*of[_\s-]*span/i,key:"spanLengthFt"},{re:/mid[_\s-]*span|midspan/i,key:"midspanFt"},{re:/attach|proposed[_\s-]*attach|attachment[_\s-]*height/i,key:"proposedAttachFt"},{re:/owner|utility[_\s-]*owner/i,key:"owner"},{re:/company|communications[_\s-]*company|comm[_\s-]*company/i,key:"commCompany"},{re:/route|road|highway/i,key:"route"}];function $(i,l){if(!i)return null;for(const n of J)if(n.re.test(String(i)))return n.key;if(l==="wvHighway"){const n=String(i).toLowerCase();if(n.includes("mm-109")&&n.includes("applicant"))return"applicant"}return null}const q=Object.freeze(Object.defineProperty({__proto__:null,mapFieldNameToKey:$},Symbol.toStringTag,{value:"Module"}));export{U as a,X as m,E as p};
//# sourceMappingURL=app-permits-Dftu4pdj.js.map
