const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-libs-BHK3Zt8R.js","assets/vendor-Cv8-97MN.js","assets/polyfills-CELajPCl.js","assets/pdf-api-BXmHbbLX.js","assets/pdf-core-XUHen7ke.js"])))=>i.map(i=>d[i]);
import{g as pe,e as ue}from"./app-calculations-BTm-MLQ7.js";import{p as me,c as ge}from"./state-vendor-C5Drl_aA.js";import{c as he}from"./react-CcDwFy_c.js";import{o as se,n as c,b as ye,s as u,u as A,c as oe,d as re}from"./vendor-Cv8-97MN.js";import{_ as fe}from"./app-calculator-BxQMOd7r.js";const We={power:[{name:"Appalachian Power (AEP)",short:"Appalachian Power",parent:"AEP"},{name:"Wheeling Power (AEP)",short:"Wheeling Power",parent:"AEP"},{name:"Monongahela Power (Mon Power)",short:"Mon Power",parent:"FirstEnergy"},{name:"Potomac Edison",short:"Potomac Edison",parent:"FirstEnergy"},{name:"Harrison Rural Electrification Association (HREA)",short:"HREA",parent:"Cooperative"},{name:"Black Diamond Power Company",short:"Black Diamond Power",parent:"Investor-owned"},{name:"City of New Martinsville Electric",short:"New Martinsville Electric",parent:"Municipal"},{name:"City of Philippi Electric",short:"Philippi Electric",parent:"Municipal"}],communication:[{name:"Frontier Communications",short:"Frontier"},{name:"Optimum (formerly Suddenlink)",short:"Optimum"},{name:"Armstrong",short:"Armstrong"},{name:"Citynet",short:"Citynet"},{name:"Lumen (CenturyLink/Level 3)",short:"Lumen"},{name:"Zayo",short:"Zayo"},{name:"Segra (Lumos Networks)",short:"Segra"},{name:"Comcast Xfinity",short:"Comcast"},{name:"Charter Spectrum",short:"Spectrum"},{name:"AT&T",short:"AT&T"},{name:"Verizon",short:"Verizon"},{name:"T-Mobile",short:"T-Mobile"}]};try{const e=localStorage.getItem("pole-height-store");e&&typeof e=="string"&&JSON.parse(e)}catch{console.warn("Clearing corrupt persisted state");try{localStorage.removeItem("pole-height-store")}catch{}}const we=he(me(t=>({currentUser:null,setCurrentUser:e=>t({currentUser:e}),currentOrganization:null,setCurrentOrganization:e=>t({currentOrganization:e}),currentClient:null,setCurrentClient:e=>t({currentClient:e}),isAuthenticated:!1,setIsAuthenticated:e=>t({isAuthenticated:e}),uiSectionSaved:{},setSectionSaved:e=>t(n=>({uiSectionSaved:{...n.uiSectionSaved||{},[e]:new Date().toISOString()}})),poleHeight:"",setPoleHeight:e=>t({poleHeight:e}),poleClass:"",setPoleClass:e=>t({poleClass:e}),presetProfile:"",setPresetProfile:e=>t({presetProfile:e}),customMinTopSpace:"",setCustomMinTopSpace:e=>t({customMinTopSpace:e}),customRoadClearance:"",setCustomRoadClearance:e=>t({customRoadClearance:e}),customCommToPower:"",setCustomCommToPower:e=>t({customCommToPower:e}),useTickMarkFormat:!1,setUseTickMarkFormat:e=>t({useTickMarkFormat:e}),preferAutoSpanLength:!1,setPreferAutoSpanLength:e=>t({preferAutoSpanLength:e}),spanLenDeltaThresholdFt:10,setSpanLenDeltaThresholdFt:e=>t({spanLenDeltaThresholdFt:Number(e)||0}),tableDensity:"comfortable",setTableDensity:e=>t({tableDensity:e==="compact"?"compact":"comfortable"}),spansColumnSegmentsVisible:!0,setSpansColumnSegmentsVisible:e=>t({spansColumnSegmentsVisible:!!e}),spansColumnActionsVisible:!0,setSpansColumnActionsVisible:e=>t({spansColumnActionsVisible:!!e}),projectName:"",setProjectName:e=>t({projectName:e}),applicantName:"",setApplicantName:e=>t({applicantName:e}),jobNumber:"",setJobNumber:e=>t({jobNumber:e}),jobOwner:"",setJobOwner:e=>t({jobOwner:e}),setJobOwnerAutoProfile:e=>t(n=>{const a=String(e||"").toLowerCase();let i=n.currentSubmissionProfile||"generic";return/first\s*energy|mon\s*power|penelec|potomac|west\s*penn|jcp&l|jersey\s*central|ohio\s*edison|illuminating|toledo/i.test(a)?i="firstEnergy":/duke/i.test(a)&&(i="duke"),{jobOwner:e||"",currentSubmissionProfile:i}}),poleLatitude:"",setPoleLatitude:e=>t({poleLatitude:e}),poleLongitude:"",setPoleLongitude:e=>t({poleLongitude:e}),logoDataUrl:"",setLogoDataUrl:e=>t({logoDataUrl:e}),existingPowerHeight:"",setExistingPowerHeight:e=>t({existingPowerHeight:e}),existingPowerVoltage:"distribution",setExistingPowerVoltage:e=>t({existingPowerVoltage:e}),spanDistance:"",setSpanDistance:e=>t({spanDistance:e}),spanEnvironment:"road",setSpanEnvironment:e=>t({spanEnvironment:e}),isNewConstruction:!0,setIsNewConstruction:e=>t({isNewConstruction:e}),attachmentType:"communication",setAttachmentType:e=>t({attachmentType:e}),cableDiameter:"",setCableDiameter:e=>t({cableDiameter:e}),windSpeed:"90",setWindSpeed:e=>t({windSpeed:e}),iceThicknessIn:"0",setIceThicknessIn:e=>t({iceThicknessIn:e}),hasTransformer:!1,setHasTransformer:e=>t({hasTransformer:e}),hasStreetlight:!1,setHasStreetlight:e=>t({hasStreetlight:e}),requiresGuying:!1,setRequiresGuying:e=>t({requiresGuying:e}),streetLightHeight:"",setStreetLightHeight:e=>t({streetLightHeight:e}),dripLoopHeight:"",setDripLoopHeight:e=>t({dripLoopHeight:e}),powerReference:"auto",setPowerReference:e=>t({powerReference:e}),proposedLineHeight:"",setProposedLineHeight:e=>t({proposedLineHeight:e}),submissionProfiles:[{name:"firstEnergy",label:"FirstEnergy / Mon Power",commToPowerIn:44,minTopSpaceFt:2,roadClearanceFt:18,envRoadFt:18,envResidentialFt:15.5,envPedestrianFt:15.5,envFieldFt:15.5,envResidentialYardFt:9.5,envResidentialDrivewayFt:15.5,envNonResidentialDrivewayFt:16,envWaterwayFt:14,envWVHighwayFt:18,envPAHighwayFt:18,envOHHighwayFt:18,envMDHighwayFt:18,envInterstateFt:18,envInterstateNewCrossingFt:21,envRailroadFt:27,minCommAttachFt:14,manifestType:"FE"},{name:"aep",label:"AEP (Generic)",commToPowerIn:40,minTopSpaceFt:2,roadClearanceFt:18,envRoadFt:18,envResidentialFt:15.5,envPedestrianFt:15.5,envFieldFt:15.5,envResidentialYardFt:9.5,envResidentialDrivewayFt:15.5,envNonResidentialDrivewayFt:16,envWaterwayFt:14,envWVHighwayFt:18,envPAHighwayFt:18,envOHHighwayFt:18,envMDHighwayFt:18,envInterstateFt:18,envInterstateNewCrossingFt:21,envRailroadFt:27,minCommAttachFt:14,manifestType:"AEP"},{name:"duke",label:"Duke Energy",commToPowerIn:40,minTopSpaceFt:1,roadClearanceFt:18,envRoadFt:18,envResidentialFt:15.5,envPedestrianFt:15.5,envFieldFt:15.5,envResidentialYardFt:9.5,envResidentialDrivewayFt:15.5,envNonResidentialDrivewayFt:16,envWaterwayFt:14,envWVHighwayFt:18,envPAHighwayFt:18,envOHHighwayFt:18,envMDHighwayFt:18,envInterstateFt:18,envInterstateNewCrossingFt:21,envRailroadFt:27,minCommAttachFt:14,manifestType:"DUKE"},{name:"generic",label:"Generic / NESC",commToPowerIn:40,minTopSpaceFt:1,roadClearanceFt:18,envRoadFt:18,envResidentialFt:15.5,envPedestrianFt:15.5,envFieldFt:15.5,envResidentialYardFt:9.5,envResidentialDrivewayFt:15.5,envNonResidentialDrivewayFt:16,envWaterwayFt:14,envWVHighwayFt:18,envPAHighwayFt:18,envOHHighwayFt:18,envMDHighwayFt:18,envInterstateFt:18,envInterstateNewCrossingFt:21,envRailroadFt:27,minCommAttachFt:14,manifestType:"GEN"}],currentSubmissionProfile:"firstEnergy",setCurrentSubmissionProfile:e=>t({currentSubmissionProfile:e}),updateSubmissionProfile:(e,n)=>t(a=>({submissionProfiles:(a.submissionProfiles||[]).map(r=>r.name===e?{...r,...n}:r)})),adjacentPoleHeight:"",setAdjacentPoleHeight:e=>t({adjacentPoleHeight:e}),existingLines:[{type:"",height:"",makeReady:!1,makeReadyHeight:"",companyName:""}],setExistingLines:e=>t({existingLines:e}),makeReadyNotes:"",setMakeReadyNotes:e=>t({makeReadyNotes:e}),results:null,setResults:e=>t({results:e}),warnings:[],setWarnings:e=>t({warnings:e}),engineeringNotes:[],setEngineeringNotes:e=>t({engineeringNotes:e}),guyAnalysis:null,setGuyAnalysis:e=>t({guyAnalysis:e}),costAnalysis:null,setCostAnalysis:e=>t({costAnalysis:e}),setAnalysis:e=>t(()=>{const{results:n,warnings:a,notes:i,cost:r}=e||{};return{results:n!=null?n:null,warnings:a!=null?a:[],engineeringNotes:i!=null?i:[],costAnalysis:r!=null?r:null}}),recommendAttachHeight:(e,n="road")=>{try{const a=pe("communication",n),i=ue(a,we.getState().currentSubmissionProfile),r=(i==null?void 0:i.roadClearance)||a.roadClearance;return{recommendedFt:Math.max(Number(e)||0,r+1),targetFt:r}}catch{return{recommendedFt:Number(e)||0,targetFt:0}}},scenarioA:null,setScenarioA:e=>t({scenarioA:e}),scenarioB:null,setScenarioB:e=>t({scenarioB:e}),mappingPreset:"generic",setMappingPreset:e=>t({mappingPreset:e}),mappingProfiles:[],addMappingProfile:(e,n)=>t(a=>({mappingProfiles:[...(a.mappingProfiles||[]).filter(r=>r.name!==e),{name:e,mapping:n}]})),setMappingProfiles:e=>t(n=>{const a=new Map;for(const i of n.mappingProfiles||[])a.set(i.name,i);for(const i of e||[])i!=null&&i.name&&(i!=null&&i.mapping)&&a.set(i.name,i);return{mappingProfiles:Array.from(a.values())}}),removeMappingProfile:e=>t(n=>({mappingProfiles:(n.mappingProfiles||[]).filter(a=>a.name!==e)})),renameMappingProfile:(e,n)=>t(a=>({mappingProfiles:(a.mappingProfiles||[]).map(r=>r.name===e?{...r,name:n}:r)})),importedPoles:[],setImportedPoles:e=>t({importedPoles:e||[]}),jobs:[],currentJobId:"",addJob:e=>t(n=>{const a=(e==null?void 0:e.id)||String(Date.now()),i={id:a,name:(e==null?void 0:e.name)||"Untitled Job",applicantName:(e==null?void 0:e.applicantName)||"",jobNumber:(e==null?void 0:e.jobNumber)||"",presetProfile:(e==null?void 0:e.presetProfile)||"",jobOwner:(e==null?void 0:e.jobOwner)||"",notes:(e==null?void 0:e.notes)||"",createdAt:(e==null?void 0:e.createdAt)||new Date().toISOString(),commCompany:(e==null?void 0:e.commCompany)||"",submissionProfileName:(e==null?void 0:e.submissionProfileName)||n.currentSubmissionProfile||"generic",submissionProfileOverrides:(e==null?void 0:e.submissionProfileOverrides)||{},exportProfile:(e==null?void 0:e.exportProfile)||"generic"};return{jobs:[...n.jobs||[],i],currentJobId:a,projectName:i.name,applicantName:i.applicantName,jobNumber:i.jobNumber,presetProfile:i.presetProfile,jobOwner:i.jobOwner}}),updateJob:(e,n)=>t(a=>{const i=(a.jobs||[]).map(o=>o.id===e?{...o,...n}:o),r=i.find(o=>o.id===a.currentJobId),s=r?{projectName:r.name,applicantName:r.applicantName,jobNumber:r.jobNumber,presetProfile:r.presetProfile,jobOwner:r.jobOwner||""}:{};return{jobs:i,...s}}),removeJob:e=>t(n=>{var o;const a=(n.jobs||[]).filter(l=>l.id!==e);let i=n.currentJobId;i===e&&(i=((o=a[0])==null?void 0:o.id)||"");const r=a.find(l=>l.id===i),s=r?{projectName:r.name,applicantName:r.applicantName,jobNumber:r.jobNumber,presetProfile:r.presetProfile,jobOwner:r.jobOwner||""}:{};return{jobs:a,currentJobId:i,...s}}),setCurrentJobId:e=>t(n=>{const a=(n.jobs||[]).find(i=>i.id===e);return a?{currentJobId:e,projectName:a.name,applicantName:a.applicantName,jobNumber:a.jobNumber,presetProfile:a.presetProfile,jobOwner:a.jobOwner||""}:{currentJobId:e}}),collectedPoles:[],setCollectedPoles:e=>t({collectedPoles:e||[]}),addCollectedPole:e=>t(n=>{var i,r;const a=(e==null?void 0:e.jobId)||n.currentJobId||"";return{collectedPoles:[...n.collectedPoles||[],{asBuilt:{attachHeight:((i=e==null?void 0:e.asBuilt)==null?void 0:i.attachHeight)||"",powerHeight:((r=e==null?void 0:e.asBuilt)==null?void 0:r.powerHeight)||""},...e,jobId:a}]}}),updateCollectedPole:(e,n)=>t(a=>{const i=(a.collectedPoles||[]).slice();return e>=0&&e<i.length&&(i[e]={...i[e],...n}),{collectedPoles:i}}),removeCollectedPole:e=>t(n=>{const a=(n.collectedPoles||[]).slice();return e>=0&&e<a.length&&a.splice(e,1),{collectedPoles:a}}),importedSpans:[],setImportedSpans:e=>t({importedSpans:e||[]}),updateImportedSpan:(e,n)=>t(a=>{const i=(a.importedSpans||[]).slice();return e>=0&&e<i.length&&(i[e]={...i[e],...n}),{importedSpans:i}}),cachedMidspans:[],addCachedMidspan:e=>t(n=>({cachedMidspans:[...n.cachedMidspans||[],{id:String(Date.now()),...e}]})),updateCachedMidspan:(e,n)=>t(a=>({cachedMidspans:(a.cachedMidspans||[]).map(i=>i.id===e?{...i,...n}:i)})),removeCachedMidspan:e=>t(n=>({cachedMidspans:(n.cachedMidspans||[]).filter(a=>a.id!==e)})),clearCachedMidspans:()=>t({cachedMidspans:[]}),importedExistingLines:[],setImportedExistingLines:e=>t({importedExistingLines:e||[]}),existingLinesCSV:"",setExistingLinesCSV:e=>t({existingLinesCSV:e}),csvLineMapping:{type:"type",company:"company",height:"height",makeReady:"makeReady",makeReadyHeight:"makeReadyHeight"},setCsvLineMapping:e=>t({csvLineMapping:e}),pdfLayouts:{},savePdfLayout:(e,n,a)=>t(i=>{const r=i.currentJobId||"_global",s={...i.pdfLayouts||{}},o={...s[r]||{}},l={...o[e]||{}};return l[n||"Default"]=Array.isArray(a)?a:[],o[e]=l,s[r]=o,{pdfLayouts:s}}),removePdfLayout:(e,n)=>t(a=>{const i=a.currentJobId||"_global",r={...a.pdfLayouts||{}},s={...r[i]||{}},o={...s[e]||{}};return n in o&&delete o[n],s[e]=o,r[i]=s,{pdfLayouts:r}}),reset:()=>t({uiSectionSaved:{},poleHeight:"",poleClass:"",presetProfile:"",customMinTopSpace:"",customRoadClearance:"",customCommToPower:"",useTickMarkFormat:!1,preferAutoSpanLength:!1,spanLenDeltaThresholdFt:10,tableDensity:"comfortable",spansColumnSegmentsVisible:!0,spansColumnActionsVisible:!0,projectName:"",applicantName:"",jobNumber:"",jobOwner:"",logoDataUrl:"",poleLatitude:"",poleLongitude:"",existingPowerHeight:"",existingPowerVoltage:"distribution",spanDistance:"",spanEnvironment:"road",isNewConstruction:!0,attachmentType:"communication",cableDiameter:"",windSpeed:"90",iceThicknessIn:"0",hasTransformer:!1,hasStreetlight:!1,requiresGuying:!1,streetLightHeight:"",dripLoopHeight:"",powerReference:"auto",proposedLineHeight:"",submissionProfiles:[{name:"firstEnergy",label:"FirstEnergy / Mon Power",commToPowerIn:44,minTopSpaceFt:2,roadClearanceFt:18,envRoadFt:18,envResidentialFt:15.5,envPedestrianFt:15.5,envFieldFt:15.5,envResidentialYardFt:9.5,envResidentialDrivewayFt:15.5,envNonResidentialDrivewayFt:16,envWaterwayFt:14,envWVHighwayFt:18,envPAHighwayFt:18,envOHHighwayFt:18,envMDHighwayFt:18,envInterstateFt:18,envInterstateNewCrossingFt:21,envRailroadFt:27,minCommAttachFt:14,manifestType:"FE"},{name:"aep",label:"AEP (Generic)",commToPowerIn:40,minTopSpaceFt:2,roadClearanceFt:18,envRoadFt:18,envResidentialFt:15.5,envPedestrianFt:15.5,envFieldFt:15.5,envResidentialYardFt:9.5,envResidentialDrivewayFt:15.5,envNonResidentialDrivewayFt:16,envWaterwayFt:14,envWVHighwayFt:18,envPAHighwayFt:18,envOHHighwayFt:18,envMDHighwayFt:18,envInterstateFt:18,envInterstateNewCrossingFt:21,envRailroadFt:27,minCommAttachFt:14,manifestType:"AEP"},{name:"duke",label:"Duke Energy",commToPowerIn:40,minTopSpaceFt:1,roadClearanceFt:18,envRoadFt:18,envResidentialFt:15.5,envPedestrianFt:15.5,envFieldFt:15.5,envResidentialYardFt:9.5,envResidentialDrivewayFt:15.5,envNonResidentialDrivewayFt:16,envWaterwayFt:14,envWVHighwayFt:18,envPAHighwayFt:18,envOHHighwayFt:18,envMDHighwayFt:18,envInterstateFt:18,envInterstateNewCrossingFt:21,envRailroadFt:27,minCommAttachFt:14,manifestType:"DUKE"},{name:"generic",label:"Generic / NESC",commToPowerIn:40,minTopSpaceFt:1,roadClearanceFt:18,envRoadFt:18,envResidentialFt:15.5,envPedestrianFt:15.5,envFieldFt:15.5,envResidentialYardFt:9.5,envResidentialDrivewayFt:15.5,envNonResidentialDrivewayFt:16,envWaterwayFt:14,envWVHighwayFt:18,envPAHighwayFt:18,envOHHighwayFt:18,envMDHighwayFt:18,envInterstateFt:18,envInterstateNewCrossingFt:21,envRailroadFt:27,minCommAttachFt:14,manifestType:"GEN"}],currentSubmissionProfile:"firstEnergy",adjacentPoleHeight:"",existingLines:[{type:"",height:"",makeReady:!1,makeReadyHeight:"",companyName:""}],makeReadyNotes:"",results:null,warnings:[],engineeringNotes:[],guyAnalysis:null,costAnalysis:null,scenarioA:null,scenarioB:null,mappingPreset:"generic",mappingProfiles:[],importedPoles:[],collectedPoles:[],importedSpans:[],cachedMidspans:[],importedExistingLines:[],existingLinesCSV:"",csvLineMapping:{type:"type",company:"company",height:"height",makeReady:"makeReady",makeReadyHeight:"makeReadyHeight"},pdfLayouts:{}})}),{name:"pole-height-store",storage:ge(()=>localStorage)}));function Je({title:t,description:e}){try{t&&(document.title=t);let n=document.querySelector('meta[name="description"]');n||(n=document.createElement("meta"),n.setAttribute("name","description"),document.head.appendChild(n)),e&&n.setAttribute("content",e)}catch{}}function ve(t=[]){return["index,error",...t.map((n,a)=>`${a},"${String(n).replace(/"/g,'""')}"`)].join(`
`)}function Ge(t,e="validation_errors.csv"){if(!(t!=null&&t.length))return;const n=ve(t),a=new Blob([n],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(a),r=document.createElement("a");r.href=i,r.download=e,document.body.appendChild(r),r.click(),setTimeout(()=>{URL.revokeObjectURL(i),r.remove()},0)}function Be(t,e,n){const a=t||"generic",i=n||{};switch(a){case"firstEnergy":{const r=["id","latitude","longitude","height","class","powerHeight","voltage","hasTransformer","spanDistance","adjacentPoleHeight","attachmentType","status","hasPhoto","timestamp","jobId","asBuiltAttachHeight","asBuiltPowerHeight","varianceIn","variancePass","commCompany"],s=e.map(o=>{var l,d;return[o.id||"",o.latitude||"",o.longitude||"",o.height||"",o.poleClass||"",o.powerHeight||"",o.voltage||"",o.hasTransformer?"Y":"N",o.spanDistance||"",o.adjacentPoleHeight||"",o.attachmentType||"",o.status||"draft",o.photoDataUrl?"Y":"N",o.timestamp||"",o.jobId||"",((l=o.asBuilt)==null?void 0:l.attachHeight)||"",((d=o.asBuilt)==null?void 0:d.powerHeight)||"",o._varianceIn||"",o._variancePass||"",i.commCompany||""]});return{header:r,rows:s,fileLabel:"fe-spans-package"}}case"aep":{const r=["PoleID","Lat","Lon","PoleHtFt","Class","PowerHt","Voltage","XFMR","SpanFt","AdjPoleFt","Cable","Status","Photo","Timestamp","JobId","CommCompany"],s=e.map(o=>[o.id||"",o.latitude||"",o.longitude||"",o.height||"",o.poleClass||"",o.powerHeight||"",o.voltage||"",o.hasTransformer?"Y":"N",o.spanDistance||"",o.adjacentPoleHeight||"",o.attachmentType||"",o.status||"draft",o.photoDataUrl?"Y":"N",o.timestamp||"",o.jobId||"",i.commCompany||""]);return{header:r,rows:s,fileLabel:"aep-application-package"}}case"duke":{const r=["PoleTag","Latitude","Longitude","PoleHeightFt","Class","PowerHtFt","VoltageClass","HasXFMR","SpanLengthFt","AdjPoleHtFt","Attachment","Status","PhotoIncluded","Timestamp","JobId","CommCompany"],s=e.map(o=>[o.id||"",o.latitude||"",o.longitude||"",o.height||"",o.poleClass||"",o.powerHeight||"",o.voltage||"",o.hasTransformer?"Y":"N",o.spanDistance||"",o.adjacentPoleHeight||"",o.attachmentType||"",o.status||"draft",o.photoDataUrl?"Y":"N",o.timestamp||"",o.jobId||"",i.commCompany||""]);return{header:r,rows:s,fileLabel:"duke-application-package"}}default:{const r=["id","lat","lon","height","class","span","status","photo","jobId","commCompany"],s=e.map(o=>[o.id||"",o.latitude||"",o.longitude||"",o.height||"",o.poleClass||"",o.spanDistance||"",o.status||"draft",o.photoDataUrl?"Y":"N",o.jobId||"",i.commCompany||""]);return{header:r,rows:s,fileLabel:"utility-package"}}}}function $e(t,e){const n=a=>String(a!=null?a:"").replaceAll('"','""');return[t.join(","),...e.map(a=>a.map(n).join(","))].join(`
`)}function Fe(t){const e=typeof t=="number"?t:parseFloat(t);return isNaN(e)?{valid:!1,error:"Latitude must be a valid number"}:e<-90||e>90?{valid:!1,error:"Latitude must be between -90 and 90 degrees"}:{valid:!0,value:e}}function be(t){const e=typeof t=="number"?t:parseFloat(t);return isNaN(e)?{valid:!1,error:"Longitude must be a valid number"}:e<-180||e>180?{valid:!1,error:"Longitude must be between -180 and 180 degrees"}:{valid:!0,value:e}}function Pe(t,e){const n=[],a=Fe(t);a.valid||n.push(a.error);const i=be(e);return i.valid||n.push(i.error),n.length>0?{valid:!1,errors:n}:{valid:!0,coordinates:[i.value,a.value]}}function qe(t){const e=[],n=[];if(t.latitude===void 0&&t.longitude===void 0)return n.push("No coordinates provided for pole"),{valid:!0,warnings:n};if(t.latitude!==void 0&&t.latitude!==null&&(t.longitude===void 0||t.longitude===null)&&e.push("Latitude provided without longitude"),t.longitude!==void 0&&t.longitude!==null&&(t.latitude===void 0||t.latitude===null)&&e.push("Longitude provided without latitude"),t.latitude!==void 0&&t.latitude!==null&&t.longitude!==void 0&&t.longitude!==null){const a=Pe(t.latitude,t.longitude);if(a.valid||e.push(...a.errors),a.valid&&a.coordinates[0]===0&&a.coordinates[1]===0&&n.push("Coordinates are at [0, 0] - this is likely unintentional"),a.valid){const i=Math.abs(a.coordinates[1]),r=Math.abs(a.coordinates[0]);i<.001&&r<.001&&!(i===0&&r===0)&&n.push("Coordinates very close to [0, 0] - please verify")}}return{valid:e.length===0,errors:e,warnings:n.length>0?n:[]}}const le=se({id:u().optional(),latitude:A([c().finite(),oe()]).optional(),longitude:A([c().finite(),oe()]).optional(),height:A([c(),u()]).optional(),class:u().optional(),powerHeight:A([c(),u()]).optional(),voltage:u().optional(),hasTransformer:ye().optional(),incomingBearingDeg:c().min(0).max(360).optional(),outgoingBearingDeg:c().min(0).max(360).optional(),PULL_ft:c().min(0).optional()}),ce=se({id:u().optional(),fromId:re().optional(),toId:re().optional(),length:c().min(0).optional(),proposedAttach:A([c(),u()]).optional(),environment:u().optional(),incomingBearingDeg:c().min(0).max(360).optional(),outgoingBearingDeg:c().min(0).max(360).optional(),PULL_ft:c().min(0).optional()});function Ce(t){if(!Array.isArray(t))return{errors:["Poles must be an array"],data:[]};const e=[],n=[];return t.forEach((a,i)=>{const r=le.safeParse(a);r.success?n.push(r.data):e.push(`Pole[${i}]: ${r.error.issues.map(s=>s.message).join("; ")}`)}),{errors:e,data:n}}function Ne(t){if(!Array.isArray(t))return{errors:["Spans must be an array"],data:[]};const e=[],n=[];return t.forEach((a,i)=>{const r=ce.safeParse(a);r.success?n.push(r.data):e.push(`Span[${i}]: ${r.error.issues.map(s=>s.message).join("; ")}`)}),{errors:e,data:n}}const Ye=Object.freeze(Object.defineProperty({__proto__:null,PoleSchema:le,SpanSchema:ce,validatePoles:Ce,validateSpans:Ne},Symbol.toStringTag,{value:"Module"})),He={agencies:{wvdot:{name:"West Virginia Division of Highways (WVDOT)",environments:["wvHighway"],resources:[{label:"MM-109 Right of Way Entry Permit (PDF)",url:"https://transportation.wv.gov/highways/right-of-way/Documents/Railroads%20%26%20Utils%202023/MM-109%20Right%20of%20Way%20Entry%20Permit%20Application.pdf",notes:"Primary application for right-of-way entry; attach plans, traffic control, and calculations."},{label:"Alternate MM-109 link",url:"https://transportation.wv.gov/highways/engineering/files/MM-109.pdf",notes:"Alternate mirror link referenced by WV regulations."}],requirements:["Completed MM-109 application with applicant and contact info","Location details with GPS where available","Plan/profile drawing showing ground clearance and midspan","Traffic control plan (if work impacts traffic)","Bond/deposit as required by district","Proof of utility coordination as applicable"]},penndot:{name:"PennDOT (Pennsylvania Department of Transportation)",environments:["paHighway"],resources:[{label:"HOP ePermitting Portal",url:"https://www.epermitting.penndot.gov/EPS/home/home.jsp",notes:"Highway Occupancy Permit (HOP) applications are submitted online."},{label:"Form M-945A: Application for Highway Occupancy Permit (PDF)",url:"https://www.pa.gov/content/dam/copapwp-pagov/en/penndot/documents/public/pubsforms/forms/m-945a.pdf",notes:"Reference application document. Actual submission via ePermitting."},{label:"General HOP Guidance",url:"https://www.pa.gov/services/penndot/apply-for-a-penndot-highway-occupancy-permit.html",notes:"Overview of HOP process and forms."}],requirements:["Online application via HOP ePermitting","Location plan and traffic control (if applicable)","Utility coordination and restoration details","Clearance calculations and drawings for overhead crossings"]},odot:{name:"Ohio Department of Transportation (ODOT)",environments:["ohHighway"],resources:[{label:"ODOT Permits (Utility)",url:"https://www.transportation.ohio.gov/wps/portal/gov/odot/programs/utility",notes:"Utility accommodation and permitting resources for state routes."}],requirements:["Utility permit application through ODOT district","Plans showing location, clearances, and traffic control","Compliance with utility accommodation policy"]},mdot:{name:"Maryland DOT State Highway Administration (MDOT SHA)",environments:["mdHighway"],resources:[{label:"MDOT SHA Utility Permits",url:"https://www.roads.maryland.gov/Pages/default.aspx?PageId=775",notes:"Utility permit information and contacts for state highways."}],requirements:["Utility permit application with location plans","Clearance/encroachment drawings and traffic control where needed","District coordination and conditions"]},csx:{name:"CSX Transportation (Railroad)",environments:["railroad"],resources:[{label:"CSX Property Portal – Utility Permits",url:"https://www.csx.com/index.cfm/customers/value-added-services/property-real-estate/permitting-utility-wireless-infrastructure-installations-and-rights-of-entry/utility-permits/",notes:"Submit applications online; see fees and processing info."},{label:"Application for Facility/Utility Installations (sample PDF)",url:"https://www.csx.com/index.cfm/library/files/customers/property-real-estate/permitting/utility-permits/facility-encroachment-application/",notes:"Reference form; current process uses CSX Property Portal."}],requirements:["Online application via CSX Property Portal","Plan/profile drawings with vertical and horizontal clearances","Insurance and fee payment per CSX requirements"]}}};function de(t){const e=[],{agencies:n}=He;for(const a of Object.keys(n)){const i=n[a];(i.environments||[]).includes(t)&&e.push({key:a,...i})}return e}function Se(t){var a,i;const e=de(t)||[];if(!e.length)return"";const n=[];for(const r of e){if(n.push(`Agency: ${r.name}`),(a=r.resources)!=null&&a.length){n.push("Resources:");for(const s of r.resources)n.push(`- ${s.label}: ${s.url}`),s.notes&&n.push(`  Notes: ${s.notes}`)}if((i=r.requirements)!=null&&i.length){n.push("Common Requirements:");for(const s of r.requirements)n.push(`- ${s}`)}n.push("")}return n.join(`
`)}const Xe=Object.freeze(Object.defineProperty({__proto__:null,buildTemplatesText:Se,getTemplatesForEnvironment:de},Symbol.toStringTag,{value:"Module"}));function R(t){var n,a,i,r,s,o,l,d,h,y,f,w,v,F,b,P,C,N,H,S,I,L,k,x,T,m,p,O,E,j,z,V,_,U,W,J,G,B,$,q,Y,X,K,Z,Q,ee,te,ne,ae,ie;const e=t||{};return{type:e.type||"",applicant:((n=e.job)==null?void 0:n.applicant)||"",jobName:((a=e.job)==null?void 0:a.name)||"",jobNumber:((i=e.job)==null?void 0:i.jobNumber)||"",owner:((r=e.job)==null?void 0:r.owner)||"",commCompany:((s=e.job)==null?void 0:s.commCompany)||"",submissionProfileName:((o=e.job)==null?void 0:o.submissionProfileName)||"",manifestType:((l=e.profile)==null?void 0:l.manifestType)||"",environment:e.environment||"",poleHeightFt:(h=(d=e.pole)==null?void 0:d.heightFt)!=null?h:"",poleClass:((y=e.pole)==null?void 0:y.class)||"",poleLatitude:((w=(f=e.pole)==null?void 0:f.gps)==null?void 0:w.lat)||"",poleLongitude:((F=(v=e.pole)==null?void 0:v.gps)==null?void 0:F.lon)||"",midLatitude:((b=e.span)==null?void 0:b.midLatitude)||"",midLongitude:((P=e.span)==null?void 0:P.midLongitude)||"",fromPoleId:((H=(N=(C=e.span)==null?void 0:C.endpoints)==null?void 0:N.from)==null?void 0:H.id)||"",toPoleId:((L=(I=(S=e.span)==null?void 0:S.endpoints)==null?void 0:I.to)==null?void 0:L.id)||"",fromLatitude:((T=(x=(k=e.span)==null?void 0:k.endpoints)==null?void 0:x.from)==null?void 0:T.latitude)||"",fromLongitude:((O=(p=(m=e.span)==null?void 0:m.endpoints)==null?void 0:p.from)==null?void 0:O.longitude)||"",toLatitude:((z=(j=(E=e.span)==null?void 0:E.endpoints)==null?void 0:j.to)==null?void 0:z.latitude)||"",toLongitude:((U=(_=(V=e.span)==null?void 0:V.endpoints)==null?void 0:_.to)==null?void 0:U.longitude)||"",powerVoltage:((W=e.power)==null?void 0:W.voltage)||"",powerHeight:((J=e.power)==null?void 0:J.heightFt)||"",spanLengthFt:(B=(G=e.span)==null?void 0:G.lengthFt)!=null?B:"",midspanFt:(q=($=e.span)==null?void 0:$.midspanFt)!=null?q:"",targetGroundClearanceFt:(X=(Y=e.span)==null?void 0:Y.targetFt)!=null?X:"",computedGroundClearanceFt:(Z=(K=e.span)==null?void 0:K.computedGroundClearanceFt)!=null?Z:"",targetSource:((Q=e.span)==null?void 0:Q.targetSource)||"",attachProposedFt:(te=(ee=e.attach)==null?void 0:ee.proposedFt)!=null?te:"",attachBasis:((ne=e.attach)==null?void 0:ne.basis)||"",attachDetail:((ae=e.attach)==null?void 0:ae.detail)||"",generatedAt:((ie=e.timestamps)==null?void 0:ie.generatedAt)||new Date().toISOString()}}function Ie(t){const e=R(t);return{...e,applicantCompany:e.applicant,roadwayType:e.environment,latitude:e.poleLatitude,longitude:e.poleLongitude}}function Le(t){const e=R(t);return{...e,applicantCompany:e.applicant,crossingType:e.environment,latitude:e.poleLatitude,longitude:e.poleLongitude}}function ke(t,e){const n=R(t);return{...n,agency:e||"State DOT",roadwayType:n.environment,latitude:n.poleLatitude,longitude:n.poleLongitude}}const Ke=Object.freeze(Object.defineProperty({__proto__:null,buildCSXFields:Le,buildMM109Fields:Ie,buildStateHighwayFields:ke},Symbol.toStringTag,{value:"Module"}));let D=null;async function M(){if(D)return D;try{if(window.PDFLib)return D=window.PDFLib,window.PDFLib;const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js",t.async=!0;const e=new Promise((n,a)=>{t.onload=()=>{window.PDFLib?(D=window.PDFLib,n(window.PDFLib)):a(new Error("PDF-lib failed to load from CDN"))},t.onerror=()=>a(new Error("PDF-lib CDN script failed to load"))});return document.head.appendChild(t),await e}catch(t){console.warn("CDN load failed, falling back to dynamic import:",t);try{const e=await fe(()=>import("./pdf-libs-BHK3Zt8R.js").then(n=>n.ae),__vite__mapDeps([0,1,2,3,4]));return D=e,e}catch(e){throw console.error("Both CDN and dynamic import failed:",e),new Error("Unable to load PDF library")}}}async function xe(t){const e=await M();return t(e)}async function Te(){return(await M()).PDFDocument.create()}async function De(){return M()}const Ze=Object.freeze(Object.defineProperty({__proto__:null,createPdfDocument:Te,loadPdfLib:De,withPdfLib:xe},Symbol.toStringTag,{value:"Module"}));function Ae(t){var y,f,w,v,F,b,P,C,N,H,S,I,L,k,x,T;const e=[];if(!t||typeof t!="object")return["Invalid summary"];(y=t.job)!=null&&y.name||e.push("Missing job.name"),(f=t.job)!=null&&f.jobNumber||e.push("Missing job.jobNumber"),(w=t.job)!=null&&w.applicant||e.push("Missing job.applicant"),(v=t.pole)!=null&&v.heightFt||e.push("Missing pole.heightFt"),(F=t.power)!=null&&F.heightFt||e.push("Missing power.heightFt"),(!((P=(b=t.pole)==null?void 0:b.gps)!=null&&P.lat)||!((N=(C=t.pole)==null?void 0:C.gps)!=null&&N.lon))&&e.push("Missing pole GPS coordinates"),(H=t.span)!=null&&H.lengthFt||e.push("Missing span.lengthFt"),((S=t.span)==null?void 0:S.midspanFt)==null&&e.push("Missing span.midspanFt"),(I=t.span)!=null&&I.targetFt||e.push("Missing span.targetFt");const n=t.environment,a=t.profile||{},i=g((L=t.span)==null?void 0:L.targetFt),r=g((k=t.span)==null?void 0:k.computedGroundClearanceFt),s=g((x=t.span)==null?void 0:x.midspanFt),l=[{key:"envWVHighwayFt",envValue:"wvHighway",fallback:18},{key:"envPAHighwayFt",envValue:"paHighway",fallback:18},{key:"envOHHighwayFt",envValue:"ohHighway",fallback:18},{key:"envMDHighwayFt",envValue:"mdHighway",fallback:18},{key:"envRailroadFt",envValue:"railroad",fallback:27},{key:"envInterstateNewCrossingFt",envValue:"interstateNewCrossing",fallback:21},{key:"envInterstateFt",envValue:"interstate",fallback:void 0},{key:"envRoadFt",envValue:"road",fallback:void 0}].find(m=>m.envValue===n);if(l){const m=g(a[l.key]),p=Number.isFinite(m)?m:l.fallback;Number.isFinite(p)&&(Number.isFinite(i)&&i<p&&e.push(`${Re(n)} ground clearance target below ${p} ft`),Number.isFinite(r)&&r<p&&e.push(`Computed ground clearance below ${p} ft`))}Number.isFinite(s)&&Number.isFinite(i)&&s<i&&e.push(`Midspan (${s} ft) below target (${i} ft)`);const d=g(a.minCommAttachFt),h=g((T=t.attach)==null?void 0:T.proposedFt);return Number.isFinite(d)&&Number.isFinite(h)&&h<d&&e.push(`Proposed attach below minimum ${d} ft`),e}function g(t){if(typeof t=="number")return t;if(t==null)return NaN;const e=String(t),n=e.match(/(-?\d+(?:\.\d+)?)\s*ft/),a=e.match(/(-?\d+(?:\.\d+)?)\s*in/);if(n||a){const r=n?parseFloat(n[1]):0,s=a?parseFloat(a[1]):0;return r+s/12}const i=Number(e);return Number.isFinite(i)?i:NaN}function Re(t){switch(t){case"wvHighway":return"WV Highway";case"paHighway":return"PA Highway";case"ohHighway":return"OH Highway";case"mdHighway":return"MD Highway";case"railroad":return"Railroad";case"interstate":return"Interstate";case"interstateNewCrossing":return"Interstate (New Crossing)";case"road":return"Road";default:return"Environment"}}const Qe=Object.freeze(Object.defineProperty({__proto__:null,detectPermitIssues:Ae},Symbol.toStringTag,{value:"Module"}));function Me(t){if(!t||!t.firstPage)return"unknown";const e=Math.round(t.firstPage.width),n=Math.round(t.firstPage.height);return`${t.pages}:${e}x${n}`}const Oe={wvHighway:{"1:612x792":[{key:"applicant",pageIndex:0,x:120,y:720,size:10},{key:"jobName",pageIndex:0,x:120,y:704,size:10},{key:"jobNumber",pageIndex:0,x:120,y:688,size:10},{key:"poleLatitude",pageIndex:0,x:440,y:720,size:10},{key:"poleLongitude",pageIndex:0,x:440,y:704,size:10},{key:"targetGroundClearanceFt",pageIndex:0,x:440,y:560,size:10},{key:"spanLengthFt",pageIndex:0,x:440,y:544,size:10},{key:"midspanFt",pageIndex:0,x:440,y:528,size:10},{key:"proposedAttachFt",pageIndex:0,x:440,y:512,size:10}],default:[{key:"applicant",pageIndex:0,x:110,y:710,size:10},{key:"jobName",pageIndex:0,x:110,y:694,size:10},{key:"jobNumber",pageIndex:0,x:110,y:678,size:10},{key:"poleLatitude",pageIndex:0,x:420,y:710,size:10},{key:"poleLongitude",pageIndex:0,x:420,y:694,size:10}]},paHighway:{"1:612x792":[{key:"applicant",pageIndex:0,x:120,y:730,size:10},{key:"commCompany",pageIndex:0,x:120,y:714,size:10},{key:"jobName",pageIndex:0,x:120,y:698,size:10},{key:"jobNumber",pageIndex:0,x:120,y:682,size:10},{key:"poleLatitude",pageIndex:0,x:440,y:730,size:10},{key:"poleLongitude",pageIndex:0,x:440,y:714,size:10},{key:"targetGroundClearanceFt",pageIndex:0,x:440,y:560,size:10}],default:[{key:"applicant",pageIndex:0,x:110,y:720,size:10},{key:"jobName",pageIndex:0,x:110,y:704,size:10}]},ohHighway:{"1:612x792":[{key:"applicant",pageIndex:0,x:120,y:730,size:10},{key:"jobName",pageIndex:0,x:120,y:714,size:10},{key:"jobNumber",pageIndex:0,x:120,y:698,size:10},{key:"targetGroundClearanceFt",pageIndex:0,x:440,y:560,size:10}],default:[{key:"applicant",pageIndex:0,x:110,y:720,size:10},{key:"jobName",pageIndex:0,x:110,y:704,size:10}]},mdHighway:{"1:612x792":[{key:"applicant",pageIndex:0,x:120,y:730,size:10},{key:"jobName",pageIndex:0,x:120,y:714,size:10},{key:"jobNumber",pageIndex:0,x:120,y:698,size:10},{key:"poleLatitude",pageIndex:0,x:440,y:730,size:10},{key:"poleLongitude",pageIndex:0,x:440,y:714,size:10}],default:[{key:"applicant",pageIndex:0,x:110,y:720,size:10},{key:"jobName",pageIndex:0,x:110,y:704,size:10}]},railroad:{"1:612x792":[{key:"applicant",pageIndex:0,x:120,y:730,size:10},{key:"commCompany",pageIndex:0,x:120,y:714,size:10},{key:"jobName",pageIndex:0,x:120,y:698,size:10},{key:"targetGroundClearanceFt",pageIndex:0,x:440,y:560,size:10},{key:"spanLengthFt",pageIndex:0,x:440,y:544,size:10},{key:"midspanFt",pageIndex:0,x:440,y:528,size:10},{key:"proposedAttachFt",pageIndex:0,x:440,y:512,size:10}],default:[{key:"applicant",pageIndex:0,x:110,y:720,size:10},{key:"jobName",pageIndex:0,x:110,y:704,size:10}]}};function Ee(t,e){const n=Oe[t]||{},a=Me(e);return n[a]||n.default||[]}const et=Object.freeze(Object.defineProperty({__proto__:null,getLayoutFor:Ee},Symbol.toStringTag,{value:"Module"}));export{We as W,Ye as a,Be as b,$e as c,Ge as d,Ze as e,Ke as f,Qe as g,et as h,De as l,Xe as p,Je as s,we as u,qe as v};
//# sourceMappingURL=app-utils-BDwnIIkN.js.map
