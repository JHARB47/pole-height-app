const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/zip-utils-BoTj1NZG.js","assets/polyfills-CELajPCl.js"])))=>i.map(i=>d[i]);
import{_ as se}from"./app-calculator-BxQMOd7r.js";import{R as i,j as a,r as me,L as re}from"./react-CcDwFy_c.js";import{u as ue,W as te}from"./app-utils-BDwnIIkN.js";import{E as xe}from"./app-io-D6-Ks0MZ.js";function ye(){var ee,ae;const s=ue(),[l,v]=i.useState(s.projectName||""),[N,y]=i.useState(s.applicantName||""),[P,z]=i.useState(s.jobNumber||""),[_,B]=i.useState(s.presetProfile||""),[J,$]=i.useState(s.jobOwner||""),[T,Z]=i.useState(""),[D,H]=i.useState(s.currentSubmissionProfile||"generic"),[L,V]=i.useState("generic"),[w,G]=i.useState(""),[S,W]=i.useState(""),[C,q]=i.useState(""),[O,X]=i.useState(""),[F,K]=i.useState(""),[E,Q]=i.useState(""),[A,Y]=i.useState(""),[M,ne]=i.useState("");i.useEffect(()=>{var t,d,g,c,j,u,o,r,n,p,b,x,I,k;v(s.projectName||""),y(s.applicantName||""),z(s.jobNumber||""),B(s.presetProfile||""),$(s.jobOwner||"");const e=(s.jobs||[]).find(R=>R.id===s.currentJobId);Z((e==null?void 0:e.commCompany)||""),H((e==null?void 0:e.submissionProfileName)||s.currentSubmissionProfile||"generic"),V((e==null?void 0:e.exportProfile)||"generic"),G(String((d=(t=e==null?void 0:e.submissionProfileOverrides)==null?void 0:t.commToPowerIn)!=null?d:"")),W(String((c=(g=e==null?void 0:e.submissionProfileOverrides)==null?void 0:g.minTopSpaceFt)!=null?c:"")),q(String((u=(j=e==null?void 0:e.submissionProfileOverrides)==null?void 0:j.roadClearanceFt)!=null?u:"")),X(String((r=(o=e==null?void 0:e.submissionProfileOverrides)==null?void 0:o.envRoadFt)!=null?r:"")),K(String((p=(n=e==null?void 0:e.submissionProfileOverrides)==null?void 0:n.envResidentialFt)!=null?p:"")),Q(String((x=(b=e==null?void 0:e.submissionProfileOverrides)==null?void 0:b.envPedestrianFt)!=null?x:"")),Y(String((k=(I=e==null?void 0:e.submissionProfileOverrides)==null?void 0:I.minCommAttachFt)!=null?k:""))},[s.projectName,s.applicantName,s.jobNumber,s.presetProfile,s.jobOwner,s.currentJobId,s.jobs,s.currentSubmissionProfile]);const ie=()=>{s.addJob({name:l,applicantName:N,jobNumber:P,presetProfile:_,jobOwner:J,notes:M,commCompany:T,submissionProfileName:D,exportProfile:L,submissionProfileOverrides:{commToPowerIn:w?Number(w):void 0,minTopSpaceFt:S?Number(S):void 0,roadClearanceFt:C?Number(C):void 0,envRoadFt:O?Number(O):void 0,envResidentialFt:F?Number(F):void 0,envPedestrianFt:E?Number(E):void 0,minCommAttachFt:A?Number(A):void 0}})},oe=()=>{s.currentJobId&&s.updateJob(s.currentJobId,{name:l,applicantName:N,jobNumber:P,presetProfile:_,jobOwner:J,notes:M,commCompany:T,submissionProfileName:D,exportProfile:L,submissionProfileOverrides:{commToPowerIn:w?Number(w):void 0,minTopSpaceFt:S?Number(S):void 0,roadClearanceFt:C?Number(C):void 0,envRoadFt:O?Number(O):void 0,envResidentialFt:F?Number(F):void 0,envPedestrianFt:E?Number(E):void 0,minCommAttachFt:A?Number(A):void 0}})},le=()=>{s.currentJobId&&confirm("Delete this job?")&&s.removeJob(s.currentJobId)},de=()=>{const e=(s.jobs||[]).find(d=>d.id===s.currentJobId);if(!e)return;const t={name:`${e.name||"Job"} (Copy)`,applicantName:e.applicantName||"",jobNumber:e.jobNumber||"",presetProfile:e.presetProfile||"",jobOwner:e.jobOwner||"",notes:e.notes||"",commCompany:e.commCompany||"",submissionProfileName:e.submissionProfileName||s.currentSubmissionProfile||"generic",submissionProfileOverrides:{...e.submissionProfileOverrides||{}},exportProfile:e.exportProfile||"generic"};s.addJob(t)},ce=async e=>{var t,d,g;try{if(!e)return;const c=(await se(async()=>{const{default:f}=await import("./zip-utils-BoTj1NZG.js").then(h=>h.j);return{default:f}},__vite__mapDeps([0,1]))).default,j=await e.arrayBuffer(),u=await c.loadAsync(j),o=async f=>{const h=u.file(f);if(!h)return null;const U=await h.async("string");try{return JSON.parse(U)}catch{return null}},r=await o("job/job.json"),n=await o("job/state.json"),p=await o("data/imported-poles.json"),b=await o("data/imported-spans.json"),x=await o("data/existing-lines.json"),I=await o("data/cached-midspans.json"),k={name:(r==null?void 0:r.name)||((t=r==null?void 0:r.job)==null?void 0:t.name)||"Imported Job",applicantName:(r==null?void 0:r.applicantName)||"",jobNumber:(r==null?void 0:r.jobNumber)||"",presetProfile:(r==null?void 0:r.presetProfile)||"",jobOwner:(r==null?void 0:r.jobOwner)||"",notes:(r==null?void 0:r.notes)||"",commCompany:(r==null?void 0:r.commCompany)||"",submissionProfileName:(r==null?void 0:r.submissionProfileName)||(n==null?void 0:n.submissionProfileName)||s.currentSubmissionProfile||"generic",submissionProfileOverrides:(r==null?void 0:r.submissionProfileOverrides)||{},exportProfile:(r==null?void 0:r.exportProfile)||"generic"};if(s.addJob(k),Array.isArray(n==null?void 0:n.mappingProfiles)&&s.setMappingProfiles(n.mappingProfiles),Array.isArray(p)&&s.setImportedPoles(p),Array.isArray(b)&&s.setImportedSpans(b),Array.isArray(x)&&s.setExistingLines(x),Array.isArray(I)){s.clearCachedMidspans();for(const f of I)s.addCachedMidspan(f)}const R=((d=u.file(/assets\/logo(\.[A-Za-z0-9]+)?$/))==null?void 0:d[0])||((g=u.file("assets/logo"))==null?void 0:g[0]);if(R){const f=await R.async("blob"),h=new FileReader;await new Promise(U=>{h.onload=()=>{U()},h.readAsDataURL(f)}),s.setLogoDataUrl(h.result)}alert("Job bundle imported. Switched to new job.")}catch(c){alert(`Import failed: ${(c==null?void 0:c.message)||c}`)}},pe=async()=>{try{const e=(await se(async()=>{const{default:n}=await import("./zip-utils-BoTj1NZG.js").then(p=>p.j);return{default:n}},__vite__mapDeps([0,1]))).default,t=new e,d=(s.jobs||[]).find(n=>n.id===s.currentJobId),g=(n,p)=>p.reduce((b,x)=>(x in n&&(b[x]=n[x]),b),{});t.file("job/job.json",JSON.stringify(d||{},null,2));const c={project:g(s,["projectName","applicantName","jobNumber","jobOwner"]),submissionProfiles:s.submissionProfiles,mappingProfiles:s.mappingProfiles,preferAutoSpanLength:s.preferAutoSpanLength,spanLenDeltaThresholdFt:s.spanLenDeltaThresholdFt};if(t.file("job/state.json",JSON.stringify(c,null,2)),(s.importedPoles||[]).length&&t.file("data/imported-poles.json",JSON.stringify(s.importedPoles,null,2)),(s.importedSpans||[]).length&&t.file("data/imported-spans.json",JSON.stringify(s.importedSpans,null,2)),(s.existingLines||[]).length&&t.file("data/existing-lines.json",JSON.stringify(s.existingLines,null,2)),(s.cachedMidspans||[]).length&&t.file("data/cached-midspans.json",JSON.stringify(s.cachedMidspans,null,2)),s.logoDataUrl){const p=await(await fetch(s.logoDataUrl)).arrayBuffer();t.file("assets/logo",p)}const j=await t.generateAsync({type:"blob"}),u=URL.createObjectURL(j),o=document.createElement("a"),r=((d==null?void 0:d.name)||"job").replace(/[^A-Za-z0-9_-]/g,"_");o.href=u,o.download=`${r}_bundle.zip`,o.click(),URL.revokeObjectURL(u)}catch(e){alert(`Bundle export failed: ${(e==null?void 0:e.message)||e}`)}};return a.jsxs("div",{id:"job",className:"app-section anchor-offset",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"section-title",children:"Job Setup"}),a.jsxs("div",{className:"text-xs text-gray-600",children:["Jobs: ",(s.jobs||[]).length]})]}),a.jsxs("div",{className:"section-grid mt-2 sm:grid-cols-2 lg:grid-cols-4",children:[a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Select Job"}),a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsxs("select",{className:"border rounded px-2 py-1",value:s.currentJobId||"",onChange:e=>s.setCurrentJobId(e.target.value),children:[a.jsx("option",{value:"",children:"-- None --"}),(s.jobs||[]).map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]}),a.jsx("button",{className:"text-xs px-2 py-1 border rounded",onClick:()=>s.setCurrentJobId(""),children:"Clear"})]})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Job Name"}),a.jsx("input",{className:"border rounded px-2 py-1",value:l,onChange:e=>v(e.target.value),placeholder:"Project name"})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Applicant"}),a.jsx("input",{className:"border rounded px-2 py-1",value:N,onChange:e=>y(e.target.value),placeholder:"Applicant name"})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Job #"}),a.jsx("input",{className:"border rounded px-2 py-1",value:P,onChange:e=>z(e.target.value),placeholder:"Job number"})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Preset"}),a.jsxs("select",{className:"border rounded px-2 py-1",value:_,onChange:e=>B(e.target.value),children:[a.jsx("option",{value:"",children:"default"}),a.jsx("option",{value:"firstEnergy",children:"FirstEnergy"}),a.jsx("option",{value:"firstEnergyMonPower",children:"FirstEnergy - Mon Power"}),a.jsx("option",{value:"pse",children:"PSE"}),a.jsx("option",{value:"duke",children:"Duke"}),a.jsx("option",{value:"nationalGrid",children:"National Grid"})]})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Owner (utility)"}),a.jsx("input",{list:"wv-power-companies",className:"border rounded px-2 py-1",value:J,onChange:e=>$(e.target.value),placeholder:"e.g., Mon Power, Penelec"}),a.jsx("datalist",{id:"wv-power-companies",children:te.power.map(e=>a.jsx("option",{value:e.short||e.name,children:e.name},e.name))}),a.jsx("span",{className:"text-xs text-gray-500",children:'Hint: Typing a FirstEnergy subsidiary (e.g., Mon Power) enables FE 44" rules automatically.'})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Attaching Communications Company"}),a.jsx("input",{list:"wv-comm-companies",className:"border rounded px-2 py-1",value:T,onChange:e=>Z(e.target.value),placeholder:"e.g., Frontier, Optimum"}),a.jsx("datalist",{id:"wv-comm-companies",children:te.communication.map(e=>a.jsx("option",{value:e.short||e.name,children:e.name},e.name))})]}),a.jsxs("div",{className:"sm:col-span-2 lg:col-span-4 border rounded p-2 vertical-rhythm",children:[a.jsx("div",{className:"font-medium text-sm",children:"Job Standards & Export Profile"}),a.jsxs("div",{className:"grid gap-2 sm:grid-cols-2 lg:grid-cols-4",children:[a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Submission Profile"}),a.jsx("select",{className:"border rounded px-2 py-1",value:D,onChange:e=>H(e.target.value),children:(s.submissionProfiles||[]).map(e=>a.jsx("option",{value:e.name,children:e.label},e.name))})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Export Profile"}),a.jsx("select",{className:"border rounded px-2 py-1",value:L,onChange:e=>V(e.target.value),children:(xe||[]).map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Override Comm→Power (in)"}),a.jsx("input",{className:"border rounded px-2 py-1",value:w,onChange:e=>G(e.target.value),placeholder:"blank = use profile"})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Override Min Top Space (ft)"}),a.jsx("input",{className:"border rounded px-2 py-1",value:S,onChange:e=>W(e.target.value),placeholder:"blank = use profile"})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Override Road Clearance (ft)"}),a.jsx("input",{className:"border rounded px-2 py-1",value:C,onChange:e=>q(e.target.value),placeholder:"blank = use profile"})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Override Road Midspan Target (ft)"}),a.jsx("input",{className:"border rounded px-2 py-1",value:O,onChange:e=>X(e.target.value),placeholder:"blank = use profile"})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Override Residential Midspan Target (ft)"}),a.jsx("input",{className:"border rounded px-2 py-1",value:F,onChange:e=>K(e.target.value),placeholder:"blank = use profile"})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Override Pedestrian Midspan Target (ft)"}),a.jsx("input",{className:"border rounded px-2 py-1",value:E,onChange:e=>Q(e.target.value),placeholder:"blank = use profile"})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Min Comm Attach Height (ft)"}),a.jsx("input",{className:"border rounded px-2 py-1",value:A,onChange:e=>Y(e.target.value),placeholder:"blank = use profile"}),a.jsx("span",{className:"text-xs text-gray-500",children:"Applied after separation; will be clamped to maintain required power separation."})]}),a.jsxs("label",{className:"grid gap-1 text-sm",children:[a.jsx("span",{className:"font-medium",children:"Δ Threshold for Span Length (ft)"}),a.jsx("input",{className:"border rounded px-2 py-1",type:"number",min:"0",step:"1",value:(ee=s.spanLenDeltaThresholdFt)!=null?ee:10,onChange:e=>s.setSpanLenDeltaThresholdFt(e.target.value)}),a.jsx("span",{className:"text-xs text-gray-500",children:"Used in Spans editor to highlight manual vs auto length differences."})]})]}),a.jsx("div",{className:"text-xs text-gray-600",children:'Defaults follow NESC unless the Owner maps to utilities like FirstEnergy (44" separation, 18 ft road). Overrides let you tune job-specific specs.'})]}),a.jsxs("label",{className:"grid gap-1 text-sm sm:col-span-2 lg:col-span-4",children:[a.jsx("span",{className:"font-medium",children:"Notes"}),a.jsx("textarea",{className:"border rounded px-2 py-1",rows:2,value:M,onChange:e=>ne(e.target.value),placeholder:"Optional job notes"})]})]}),a.jsx("div",{className:"section-divider"}),a.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[a.jsx("button",{className:"px-3 py-1 border rounded",onClick:ie,children:"Create"}),a.jsx("button",{className:"px-3 py-1 border rounded",onClick:oe,disabled:!s.currentJobId,children:"Update"}),a.jsx("button",{className:"px-3 py-1 border rounded text-red-700",onClick:le,disabled:!s.currentJobId,children:"Delete"}),a.jsx("button",{className:"px-3 py-1 border rounded",onClick:pe,disabled:!s.currentJobId,title:"Download job settings and datasets as a ZIP",children:"Export Job Bundle"}),a.jsx("button",{className:"px-3 py-1 border rounded",onClick:de,disabled:!s.currentJobId,children:"Duplicate Job"}),a.jsxs("label",{className:"px-3 py-1 border rounded cursor-pointer inline-flex items-center gap-2",children:[a.jsx("span",{children:"Import Job Bundle"}),a.jsx("input",{type:"file",className:"hidden",accept:"application/zip,.zip",onChange:e=>{var t;return ce((t=e.target.files)==null?void 0:t[0])}})]})]}),s.currentJobId?a.jsxs("div",{className:"mt-2 text-xs text-gray-700",children:["Active job:"," ",a.jsx("strong",{children:(ae=(s.jobs||[]).find(e=>e.id===s.currentJobId))==null?void 0:ae.name})," ","(ID: ",s.currentJobId,")"]}):null]})}class Pe extends me.Component{constructor(l){super(l),this.state={hasError:!1,error:null}}static getDerivedStateFromError(l){return{hasError:!0,error:l}}componentDidCatch(l,v){console.error("ErrorBoundary caught:",l,v)}render(){return this.state.hasError?a.jsxs("div",{style:{padding:16},children:[a.jsx("h1",{children:"Something went wrong."}),a.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:String(this.state.error)}),a.jsx("button",{onClick:()=>window.location.reload(),children:"Reload"})]}):this.props.children}}const be="Pole Plan Pro",he="/pwa-192.png",ge=[{label:"Home",url:"/"},{label:"App",url:"/app"}],m={siteTitle:be,logo:he,navigation:ge};function we({children:s}){const l=m==null?void 0:m.siteTitle,v=m==null?void 0:m.logo,N=Array.isArray(m==null?void 0:m.navigation)&&m.navigation.length>0?m.navigation:[{label:"Home",url:"/"},{label:"App",url:"/app"}];return a.jsxs(a.Fragment,{children:[a.jsx("a",{href:"#main-content",className:"skip-link",children:"Skip to main content"}),a.jsxs("header",{role:"banner",className:"top-nav","aria-label":"Primary",children:[a.jsxs(re,{to:"/",className:"brand","aria-label":`${l} home`,children:[a.jsx("img",{src:v,alt:"",width:"24",height:"24"}),a.jsx("span",{className:"brand-title",children:l})]}),a.jsx("nav",{"aria-label":"Primary navigation",className:"nav-links",children:N.map((y,P)=>a.jsx(re,{to:y.url,children:y.label},P))})]}),a.jsx("main",{id:"main-content",role:"main",children:s}),a.jsx("style",{children:`
        .skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
        .skip-link:focus{position:fixed;left:16px;top:16px;width:auto;height:auto;padding:8px 12px;background:#111827;color:#fff;border-radius:6px;z-index:10000}
        .top-nav{position:fixed;top:0;left:0;right:0;display:flex;gap:12px;align-items:center;padding:8px 12px;background:rgba(255,255,255,0.8);backdrop-filter:saturate(180%) blur(6px);z-index:9999}
        .top-nav .brand{display:flex;align-items:center;gap:8px;color:#0f172a;text-decoration:none;font-weight:700}
        .top-nav .nav-links{display:flex;gap:12px;margin-left:auto}
        .top-nav a{color:#0f172a;text-decoration:none;font-weight:600}
        body{padding-top:44px}
      `})]})}export{Pe as E,ye as J,we as S};
//# sourceMappingURL=app-components-BCHETAP-.js.map
