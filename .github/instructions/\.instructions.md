---
applyTo: "**"
---

## Provide project context and coding guidelines that AI should follow when generating code, answering questions, or reviewing changes.

## applyTo: '\*\*'

# Pole Height App — VS Code AI Agent Operational Instructions

## Purpose

This document provides embedded guidance for **AI coding agents operating inside VS Code**.  
It ensures that all generated code, comments, and GitHub interactions remain consistent with the Pole Height App’s mission, database context, and engineering standards.

---

## 1. Mission Context

The **Pole Height App** helps users measure and record pole heights (utility, lighting, or telecom) through photo analysis and trigonometric or AI estimation.  
The project integrates with GitHub for CI/CD, issue tracking, and deployment.

Agents act as _collaborative developers_—not autonomous committers—and must always:

- Explain reasoning for any code suggestion.
- Cross-verify logic against project data models.
- Maintain human-readable clarity.

---

## 2. Local VS Code Behavior

When running in VS Code, agents should:

1. Read this file (`.instructions.md`) at startup to set behavioral context.
2. Respect local project files such as `.env`, `tsconfig.json`, `.eslintrc`, and `.github/workflows/`.
3. Offer structured actions: _generate_, _review_, _fix_, _document_, or _explain_.
4. Avoid committing directly — always stage changes for human approval.
5. Log reasoning in inline comments using the form:  
   `// AI: rationale — [short explanation]`.

---

## 3. Tech Stack Awareness

- **Frontend:** React / Next.js
- **Backend:** Node.js (Express or FastAPI)
- **Database:** PostgreSQL or Firestore
- **Auth:** JWT-based, optional OAuth2
- **AI Modules:** TensorFlow.js, OpenCV (browser or server-side)
- **CI/CD:** GitHub Actions

---

## 4. Database Context (for Agent Reference)

```sql
TABLE poles (
  id SERIAL PRIMARY KEY,
  location VARCHAR,
  image_url TEXT,
  measured_height FLOAT,
  estimated_height FLOAT,
  created_at TIMESTAMP,
  user_id INTEGER
);

TABLE measurements (
  id SERIAL PRIMARY KEY,
  pole_id INTEGER,
  method VARCHAR,
  height FLOAT,
  angle FLOAT,
  distance FLOAT,
  timestamp TIMESTAMP
);
```

Agents must _read existing schema_ before generating migrations.

---

## 5. Coding Standards

- **Language:** TypeScript preferred.
- **Indentation:** 2 spaces.
- **Naming:** `camelCase` (vars), `PascalCase` (classes), `SNAKE_CASE` (env vars).
- **Commits:** [Conventional Commit format](https://www.conventionalcommits.org/).
- **Lint/Format:** Run ESLint + Prettier before proposing commits.

### Example Commit

```
feat(api): implement trigonometric pole height calculation
```

---

## 6. Agent Action Modes

Agents working in VS Code should expose (or internally map) these modes:

| Mode         | Function                                     | Example Command                                             |
| ------------ | -------------------------------------------- | ----------------------------------------------------------- |
| **Generate** | Create new feature or file                   | “Add a REST endpoint for pole height upload.”               |
| **Review**   | Audit code for bugs, security, and standards | “Review all PR diffs in backend/api.”                       |
| **Fix**      | Correct syntax or logic errors               | “Fix unhandled promise rejection in `heightController.ts`.” |
| **Explain**  | Summarize function or module logic           | “Explain pole height estimation method.”                    |
| **Document** | Update Markdown or inline documentation      | “Update `/docs/api.md` with new endpoints.”                 |

---

## 7. GitHub App Integration

When connected through GitHub:

- Add AI-authored PRs with labels `ai-generated` and `needs-review`.
- Include rationale in PR description under `## AI Notes`.
- Trigger workflows in `.github/workflows/*.yml` automatically when building or testing.
- Use `.github/ISSUE_TEMPLATE` for structured issue creation.

---

## 8. Error & Edge Handling

Agents must:

- Validate numeric units (meters, feet) in all calculations.
- Provide graceful fallbacks for missing `image_url` or metadata.
- Include `try/catch` or promise error handling around async operations.
- Never expose secrets from `.env` or GitHub Secrets.

---

## 9. Output & Reasoning Rules

When generating or editing files inside VS Code:

1. Write clear, diff-friendly code (minimal noise).
2. Include a concise reasoning block _only_ in comments or PR descriptions.
3. Do **not** overwrite `.instructions.md`.
4. Avoid speculative refactors unless explicitly prompted by a user or issue.

---

## 10. Extensibility

This configuration is **malable** — any new AI agent or tool inside VS Code should:

- Parse this file as its operational baseline.
- Merge additional instructions via `.instructions.local.md` (ignored in git).
- Sync updates automatically when the repository updates this document.

---

## 11. Example Interaction

**User:** “Implement new pole height estimator using base-angle and distance.”  
**Agent Action:**

1. Reads schema and existing `heightService.ts`.
2. Creates `calculateBaseAngleHeight()` with full unit validation.
3. Adds tests in `/tests/heightService.spec.ts`.
4. Writes commit message `feat(math): add base-angle height estimation`.
5. Pushes branch `ai/height-estimation`.

---

### Maintainers

- `@JHARB47`
- `PolePlan Pro Team`

_Last updated: 2025-10-19_
